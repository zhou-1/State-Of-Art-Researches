## 操作系统的基本原理与简单实现     

### 外设    
I/O控制器在物理上包含三个层次：I/O地址空间、I/O接口和设备控制器。         
I/O地址空间（即I/O端口），这也是CPU可以直接访问的地址。      
I/O接口是处于一组I/O端口和对应的设备控制器之间的一种硬件电路。        
设备控制器并不是所有I/O设备所必须的，只有少数复杂的设备才需要。它负责解释从I/O接口接收到的高级命令，并将其以适当的方式发送到I/O设备。典型的设备控制器就是磁盘控制器，它将CPU发送过来的读写数据指令转换成底层的磁盘操作。        
操作系统对硬件设备的控制方式主要与三种：程序循环检测方式(Programmed I/O，简称PIO)、中断驱动方式(Interrupt-driven I/O)、直接内存访问方式(DMA, Direct Memory Access)。     

### 内存     
内存是用于存放代码和数据地址的硬件，访问速度快，空间大。为高效定位代码和数据的位置，需要建立内存地址，即访问内存空间的索引。一般而言，内存地址有两个：一个是CPU通过总线访问物理内存用到的物理地址，一个是我们编写的应用程序所用到的逻辑地址（也有人称为虚拟地址）。       
80386是32位的处理器，即可以寻址的物理内存地址空间为2\^32=4G字节。为更好理解面向80386处理器的ucore操作系统，需要用到三个地址空间的概念：物理地址、线性地址和逻辑地址。       
物理内存地址空间是处理器提交到总线上用于访问计算机系统中的内存和外设的最终地址。一个计算机系统中只有一个物理地址空间。       
线性地址空间是80386处理器通过段（Segment）机制控制下的形成的地址空间。在操作系统的管理下，每个运行的应用程序有相对独立的一个或多个内存空间段，每个段有各自的起始地址和长度属性，大小不固定，这样可让多个运行的应用程序之间相互隔离，实现对地址空间的保护。       
相对而言，段机制对大量应用程序分散地使用大内存的支持能力较弱。所以Intel公司又加入了页机制，每个页的大小是固定的（一般为4KB），也可完成对内存单元的安全保护，隔离，且可有效支持大量应用程序分散地使用大内存的情况。    
应用程序看到的逻辑地址先被处理器中的段管理功能单元转换为线性地址，然后再通过80386处理器中的页管理功能单元把线性地址转换成物理地址。    
#### 上述三种地址的关系如下：     
分段机制启动、分页机制未启动：逻辑地址—->段机制处理—->线性地址=物理地址     
分段机制和分页机制都启动：逻辑地址—->段机制处理—->线性地址—->页机制处理—->物理地址     

### CPU     





